<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detail Buku - Perpustakaan MTsN 7 Banjar</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="library-wrapper">

  <div class="lib-overlay" id="libOverlay" onclick="closeLibSidebar()"></div>

  <aside class="lib-sidebar" id="libSidebar">
    <div class="lib-sidebar-header">
      <a href="perpustakaan.html" class="lib-sidebar-logo">
        <div class="lib-sidebar-logo-icon">
        <img src="img/logo.png" alt="Logo MTsN 7 Banjar">
        </div>
        <div>
          <p style="font-size:.875rem;font-weight:700;color:var(--color-slate-800);line-height:1.2;margin:0">Perpustakaan</p>
          <p style="font-size:.75rem;color:var(--color-sky-500);margin:0">MTsN 7 Banjar</p>
        </div>
      </a>
    </div>
    <nav class="lib-sidebar-nav">
      <span class="lib-sidebar-nav-label">Menu Utama</span>
      <ul class="lib-nav-list">
        <li><a href="perpustakaan.html" class="lib-sidebar-link">
          <svg class="lib-sidebar-link-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
          Beranda
        </a></li>
        <li><a href="katalog-kelas.html" class="lib-sidebar-link active">
          <svg class="lib-sidebar-link-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/><polyline points="10 2 10 10 13 7 16 10 16 2"/></svg>
          Katalog Kelas <span class="lib-sidebar-link-dot"></span>
        </a></li>
        <li><a href="buku-cerita.html" class="lib-sidebar-link">
          <svg class="lib-sidebar-link-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
          Buku Cerita
        </a></li>
        <li><a href="request-buku.html" class="lib-sidebar-link">
          <svg class="lib-sidebar-link-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="16"/><line x1="8" x2="16" y1="12" y2="12"/></svg>
          Request Buku
        </a></li>
      </ul>
      <hr class="lib-sidebar-divider">
      <a href="index.html" class="lib-sidebar-link" style="color:var(--color-slate-500)">
        <svg class="lib-sidebar-link-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
        Kembali ke Website
      </a>
    </nav>
    <div class="lib-sidebar-footer">
      <div class="lib-sidebar-help-card">
        <p style="font-size:.75rem;font-weight:600;color:var(--color-slate-700);margin:0 0 .25rem">Butuh bantuan?</p>
        <p style="font-size:.75rem;color:var(--color-slate-500);margin:0 0 .5rem">Hubungi petugas perpustakaan kami</p>
        <a href="tel:02112345678" style="font-size:.75rem;color:var(--color-sky-600);font-weight:600">(021) 1234-5678</a>
      </div>
    </div>
  </aside>

  <div class="lib-main">
    <header class="lib-topbar">
      <button class="lib-menu-btn" onclick="toggleLibSidebar()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
      </button>
      <div class="lib-search">
        <svg class="lib-search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
        <input type="text" placeholder="Cari buku, judul, penulis...">
      </div>
      <div class="lib-topbar-actions">
        <!-- <button class="lib-notif-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>
          <span class="lib-notif-dot"></span>
        </button>
        <button class="lib-profile-btn">
          <div class="lib-profile-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
          </div>
          <span class="lib-profile-name">Siswa</span>
        </button> -->
      </div>
    </header>

    <main class="lib-content" id="mainContent">
      <!-- Rendered by JS -->
    </main>
  </div>
</div>

<script src="js/data.js"></script>
<script>
function toggleLibSidebar() {
  document.getElementById('libSidebar').classList.toggle('open');
  document.getElementById('libOverlay').classList.toggle('open');
}
function closeLibSidebar() {
  document.getElementById('libSidebar').classList.remove('open');
  document.getElementById('libOverlay').classList.remove('open');
}

const params = new URLSearchParams(window.location.search);
const bookId = params.get('id');
let book = BOOKS_DATA.find(b => b.id === bookId);
if (!book) {
    book = STORY_BOOKS_DATA.find(b => b.id === bookId);
}

if (!book) {
  document.getElementById('mainContent').innerHTML = `
    <div style="text-align:center;padding:4rem 1rem">
      <div style="font-size:4rem;margin-bottom:1rem">ðŸ“š</div>
      <h2 style="color:var(--color-slate-700);margin-bottom:.5rem">Buku tidak ditemukan</h2>
      <p style="color:var(--color-slate-500);margin-bottom:1.5rem">Buku dengan ID tersebut tidak ada dalam koleksi kami.</p>
      <a href="katalog-kelas.html" style="display:inline-flex;align-items:center;gap:.5rem;color:var(--color-sky-500);font-size:.875rem;font-weight:600;text-decoration:none">
        Kembali ke Katalog
      </a>
    </div>
  `;
} else {
  document.title = book.title + ' - Perpustakaan MTsN 7 Banjar';
  const subjects = SUBJECTS_BY_PAKET[book.paket] || [];
  const subj = subjects.find(s => s.id === book.mapel);
  const related = BOOKS_DATA.filter(b => b.paket === book.paket && b.mapel === book.mapel && b.id !== book.id).slice(0, 4);
  const paketLabel = book.paket === 'kelas-7' ? 'Kelas 7' : book.paket === 'kelas-8' ? 'Kelas 8' : 'Kelas 9';

  const starsHTML = [1,2,3,4,5].map(s => `
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="${s<=4?'#fbbf24':'none'}" stroke="${s<=4?'#fbbf24':'#e2e8f0'}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
  `).join('');

  const metaItems = [
    { label: 'Halaman', value: `${book.pages} hal.`, color: '#0ea5e9', bg: '#f0f9ff', icon: '<path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><line x1="10" x2="16" y1="13" y2="13"/><line x1="10" x2="14" y1="17" y2="17"/>' },
    { label: 'Tahun', value: book.year, color: '#ec4899', bg: '#fdf2f8', icon: '<rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/>' },
    { label: 'Penerbit', value: book.publisher, color: '#f59e0b', bg: '#fffbeb', icon: '<path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/>' },
    { label: 'Edisi', value: book.edition, color: '#10b981', bg: '#ecfdf5', icon: '<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>' },
  ];

  const infoRows = [
    ['Judul', book.title],
    ['Pengarang', book.author],
    ['Penerbit', book.publisher],
    ['Tahun Terbit', book.year],
    ['Edisi', book.edition],
    ['Jumlah Halaman', `${book.pages} halaman`],
    ['Kategori', `${subj ? subj.name : 'Umum'} - ${paketLabel}`],
  ];

  const relatedHTML = related.length > 0 ? `
    <div style="margin-top:2.5rem">
      <h2 style="font-size:1.125rem;font-weight:700;color:var(--color-slate-800);margin:0 0 1.25rem">Buku Terkait</h2>
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:1rem" id="relatedGrid">
        ${related.map(rb => `
          <a href="detail-buku.html?id=${rb.id}" class="book-card">
            <div class="book-cover" style="background:${rb.gradient};height:8rem">
              <span style="font-size:2.5rem;position:relative;z-index:1">${rb.emoji}</span>
              <div class="book-cover-overlay"><div class="book-cover-badge">ðŸ“– Baca</div></div>
            </div>
            <div class="book-info">
              <p class="book-title">${rb.title}</p>
              <p class="book-author">${rb.author}</p>
            </div>
          </a>
        `).join('')}
      </div>
    </div>
  ` : '';

  document.getElementById('mainContent').innerHTML = `
    <!-- Back -->
    <a href="halaman-mapel.html?paket=${book.paket}" style="display:inline-flex;align-items:center;gap:.5rem;color:var(--color-slate-500);font-size:.875rem;text-decoration:none;margin-bottom:2rem;transition:color .2s" class="anim-slide-up">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
      Kembali ke Katalog
    </a>

    <div style="display:grid;grid-template-columns:1fr;gap:2rem" id="detailGrid">
      <!-- LEFT: Cover -->
      <div>
        <!-- Cover -->
        <div style="position:relative;border-radius:var(--radius-3xl);overflow:hidden;background:${book.gradient};box-shadow:0 20px 50px rgba(0,0,0,.15);aspect-ratio:3/4;display:flex;align-items:center;justify-content:center;margin-bottom:1.25rem">
          <span style="font-size:6rem">${book.emoji}</span>
          <div style="position:absolute;top:1rem;right:1rem">
            <button style="width:2.5rem;height:2.5rem;border-radius:var(--radius-xl);background:rgba(255,255,255,.8);backdrop-filter:blur(4px);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow-md)">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--color-slate-600)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"/></svg>
            </button>
          </div>
          <div style="position:absolute;bottom:1rem;left:1rem;right:1rem">
            <div style="background:rgba(255,255,255,.9);backdrop-filter:blur(4px);border-radius:var(--radius-2xl);padding:.875rem 1rem;box-shadow:var(--shadow-lg)">
              <p style="font-size:.75rem;font-weight:700;color:var(--color-slate-800);margin:0 0 .25rem;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden">${book.title}</p>
              <p style="font-size:.6875rem;color:var(--color-slate-500);margin:0">${book.author}</p>
            </div>
          </div>
        </div>

        <!-- Rating -->
        <div style="background:white;border-radius:var(--radius-2xl);padding:1rem;border:1px solid var(--color-slate-100);box-shadow:var(--shadow-sm);margin-bottom:1rem">
          <div style="display:flex;align-items:center;gap:.25rem;margin-bottom:.25rem">
            ${starsHTML}
            <span style="font-size:.875rem;font-weight:700;color:var(--color-slate-700);margin-left:.25rem">4.5</span>
          </div>
          <p style="font-size:.75rem;color:var(--color-slate-400);margin:0">dari 128 penilaian</p>
        </div>

        <!-- Action buttons -->
        <div style="display:flex;flex-direction:column;gap:.75rem">
          <a href="${book.link || '#'}" target="_blank" style="width:100%;text-decoration:none;display:flex;align-items:center;justify-content:center;gap:.5rem;padding:1rem;background:var(--color-sky-500);color:white;border:none;border-radius:var(--radius-2xl);font-size:.9375rem;font-weight:600;cursor:pointer;box-shadow:0 8px 20px rgba(14,165,233,.3);transition:all .2s;font-family:inherit">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
            Baca Sekarang
          </a>
        </div>
      </div>

      <!-- RIGHT: Details -->
      <div style="display:flex;flex-direction:column;gap:1.25rem">
        <!-- Title & subject -->
        <div>
          ${subj ? `<div style="display:inline-flex;align-items:center;gap:.375rem;background:var(--color-sky-50);color:var(--color-sky-600);border:1px solid var(--color-sky-100);border-radius:9999px;padding:.375rem .875rem;font-size:.75rem;margin-bottom:.75rem">${subj.icon} ${subj.name}</div>` : ''}
          <h1 style="font-size:1.5rem;font-weight:700;color:var(--color-slate-800);margin:0 0 .5rem;line-height:1.3">${book.title}</h1>
          <p style="color:var(--color-sky-500);font-weight:600;margin:0">${book.author}</p>
        </div>

        <!-- Meta grid -->
        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:.75rem">
          ${metaItems.map(m => `
            <div style="background:white;border-radius:var(--radius-2xl);padding:1rem;border:1px solid var(--color-slate-100);box-shadow:var(--shadow-sm)">
              <div style="width:2rem;height:2rem;border-radius:var(--radius-xl);background:${m.bg};display:flex;align-items:center;justify-content:center;margin-bottom:.5rem">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="${m.color}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${m.icon}</svg>
              </div>
              <p style="font-size:.6875rem;color:var(--color-slate-400);margin:0 0 .25rem">${m.label}</p>
              <p style="font-size:.8125rem;font-weight:600;color:var(--color-slate-700);margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${m.value}</p>
            </div>
          `).join('')}
        </div>

        <!-- Description -->
        <div style="background:white;border-radius:var(--radius-2xl);padding:1.5rem;border:1px solid var(--color-slate-100);box-shadow:var(--shadow-sm)">
          <h2 style="font-size:.9375rem;font-weight:700;color:var(--color-slate-800);margin:0 0 .875rem;display:flex;align-items:center;gap:.5rem">
            <span style="width:2rem;height:2rem;border-radius:var(--radius-xl);background:var(--color-sky-50);display:flex;align-items:center;justify-content:center">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--color-sky-500)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
            </span>
            Deskripsi Buku
          </h2>
          <p style="color:var(--color-slate-600);line-height:1.7;margin:0 0 1rem">${book.description}</p>
          <p style="color:var(--color-slate-500);font-size:.875rem;line-height:1.7;margin:0">Buku ini dirancang untuk mendukung pembelajaran yang aktif dan menyenangkan. Dilengkapi dengan ilustrasi berwarna, latihan soal, dan rangkuman materi di setiap bab untuk memudahkan pemahaman siswa.</p>
        </div>

        <!-- Info table -->
        <div style="background:white;border-radius:var(--radius-2xl);border:1px solid var(--color-slate-100);box-shadow:var(--shadow-sm);overflow:hidden">
          <div style="padding:1rem 1.5rem;border-bottom:1px solid var(--color-slate-100)">
            <h2 style="font-size:.9375rem;font-weight:700;color:var(--color-slate-800);margin:0">Informasi Buku</h2>
          </div>
          <div>
            ${infoRows.map((r, i) => `
              <div style="display:flex;align-items:flex-start;padding:.875rem 1.5rem;${i>0?'border-top:1px solid var(--color-slate-100)':''}">
                <span style="width:35%;font-size:.875rem;color:var(--color-slate-500);flex-shrink:0">${r[0]}</span>
                <span style="flex:1;font-size:.875rem;font-weight:500;color:var(--color-slate-800)">${r[1]}</span>
              </div>
            `).join('')}
          </div>
        </div>

        <!-- Book pages image -->
        <div style="border-radius:var(--radius-2xl);overflow:hidden;box-shadow:var(--shadow-md)">
          <img src="https://images.unsplash.com/photo-1760840415479-438f61268bed?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800" alt="Halaman buku" style="width:100%;height:10rem;object-fit:cover;display:block">
        </div>
      </div>
    </div>

    ${relatedHTML}
  `;

  // Responsive layout
  function updateLayout() {
    const grid = document.getElementById('detailGrid');
    const relGrid = document.getElementById('relatedGrid');
    if (grid) grid.style.gridTemplateColumns = window.innerWidth >= 1024 ? '1fr 2fr' : '1fr';
    if (relGrid) relGrid.style.gridTemplateColumns = window.innerWidth >= 640 ? 'repeat(4,1fr)' : 'repeat(2,1fr)';
  }
  updateLayout();
  window.addEventListener('resize', updateLayout);
}
</script>
</body>
</html>